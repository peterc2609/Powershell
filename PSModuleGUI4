Add-Type -AssemblyName System.Windows.Forms

# Create the main form
$form = New-Object System.Windows.Forms.Form
$form.Text = 'PowerShell Module Installer'
$form.Size = New-Object System.Drawing.Size(700,450)

# Label for Search Box
$searchLabel = New-Object System.Windows.Forms.Label
$searchLabel.Location = New-Object System.Drawing.Point(10,10)
$searchLabel.Size = New-Object System.Drawing.Size(400,20)
$searchLabel.Text = 'Please enter the name of the PowerShell module you require. A partial name is acceptable.'
$form.Controls.Add($searchLabel)

# Search box
$searchBox = New-Object System.Windows.Forms.TextBox
$searchBox.Location = New-Object System.Drawing.Point(10,30)
$searchBox.Size = New-Object System.Drawing.Size(260,20)
$form.Controls.Add($searchBox)

# Search button
$searchButton = New-Object System.Windows.Forms.Button
$searchButton.Location = New-Object System.Drawing.Point(280,30)
$searchButton.Size = New-Object System.Drawing.Size(100,20)
$searchButton.Text = 'Search'
$form.Controls.Add($searchButton)

# Label for Search Results
$resultsLabel = New-Object System.Windows.Forms.Label
$resultsLabel.Location = New-Object System.Drawing.Point(10,60)
$resultsLabel.Size = New-Object System.Drawing.Size(350,20)
$resultsLabel.Text = 'PowerShell Modules found:'
$form.Controls.Add($resultsLabel)

# Checkbox list for displaying search results
$checkedListBox = New-Object System.Windows.Forms.CheckedListBox
$checkedListBox.Location = New-Object System.Drawing.Point(10,80)
$checkedListBox.Size = New-Object System.Drawing.Size(350,250)
$checkedListBox.CheckOnClick = $true
$form.Controls.Add($checkedListBox)

# Add button to add selected modules to the collection
$addButton = New-Object System.Windows.Forms.Button
$addButton.Location = New-Object System.Drawing.Point(280,340)
$addButton.Size = New-Object System.Drawing.Size(80,20)
$addButton.Text = 'Add'
$form.Controls.Add($addButton)

# Label for Selected Modules
$selectedLabel = New-Object System.Windows.Forms.Label
$selectedLabel.Location = New-Object System.Drawing.Point(370,60)
$selectedLabel.Size = New-Object System.Drawing.Size(310,20)
$selectedLabel.Text = 'PowerShell modules selected for installation:'
$form.Controls.Add($selectedLabel)

# List box for displaying selected modules
$selectedListBox = New-Object System.Windows.Forms.ListBox
$selectedListBox.Location = New-Object System.Drawing.Point(370,80)
$selectedListBox.Size = New-Object System.Drawing.Size(310,250)
$form.Controls.Add($selectedListBox)

# Install button
$installButton = New-Object System.Windows.Forms.Button
$installButton.Location = New-Object System.Drawing.Point(600,340)
$installButton.Size = New-Object System.Drawing.Size(80,20)
$installButton.Text = 'Install'
$form.Controls.Add($installButton)

# Selected modules collection
$selectedModules = New-Object System.Collections.ArrayList

# Search Button Click Event
$searchButton.Add_Click({
    $checkedListBox.Items.Clear()
    $modules = Find-Module -Name "*$($searchBox.Text)*"
    foreach ($module in $modules) {
        $checkedListBox.Items.Add($module.Name)
    }
})

# Add Button Click Event
$addButton.Add_Click({
    foreach ($item in $checkedListBox.CheckedItems) {
        if ($selectedModules -notcontains $item) {
            $selectedModules.Add($item) | Out-Null
            $selectedListBox.Items.Add($item)
        }
    }
})

# Install Button Click Event
$installButton.Add_Click({
    foreach ($module in $selectedModules) {
        Install-Module -Name $module -Force -Scope CurrentUser
    }
    [System.Windows.Forms.MessageBox]::Show("Installation Complete")
})

# Show the form
$form.ShowDialog()
