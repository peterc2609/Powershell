$adapter = Get-NetAdapter | ? { $_.Status -eq "Up" -and $_.LinkSpeed -ne "0 bps" }
$index = $adapter.ifIndex

$ipProperties = Get-NetIPConfiguration -InterfaceIndex $index

if ($ipProperties.AddressOrigin -eq "Manual") {
    # Static IP, exit code 0
    exit 0
} else {
    # Not static IP, exit code 1
    exit 1
}
